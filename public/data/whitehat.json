{
    "endpoints": [
    {
        "name": "Customer API",
        "methods": [
            { 
                "MethodName": "/",
                "Synopsis": "Returns user and client information",
                "HTTPMethod": "GET",
                "URI": "/", 
                "RequiresOAuth": "N",
                "parameters": []
            }
        ]
    },
    {
            "name": "Account API",
                "methods": [
                {
                    "MethodName": "/user/:username",
                    "Synopsis": "Returns information on Sentinel user",
                    "HTTPMethod": "GET",
                    "URI": "/user/:username",
                    "RequiresOAuth": "N",
                    "parameters": [
                        {
                            "Name": "username",
                            "Required": "Y",
                            "Type": "email address"   
                        },
                        {
                            "Name": "format",
                            "Required": "N",
                            "Default": "xml",
                            "Type": "enumerated",
                            "EnumeratedList": ["text/csv", "application/json", "text/xml"]
                        }
                    ]
                },
                {
                    "MethodName": "/user",
                    "Synopsis": "Returns information on Sentinel users the current user can manage",
                    "HTTPMethod": "GET",
                    "URI": "/user",
                    "RequiresOAuth": "N",
                    "parameters": [
                        {
                            "Name": "format",
                            "Required": "N",
                            "Default": "xml",
                            "Type": "enumerated",
                            "EnumeratedList": ["text/csv", "application/json", "text/xml"]
                        }
                    ]
                }
           ]
        },
    {
        "name": "Site API",
        "methods": [
            {
                "MethodName": "/site",
                "Synopsis": "Returns information on sites user has access to",
                "HTTPMethod": "GET",
                "URI": "/site",
                "RequiresOAuth": "N",
                "parameters": [
                    {
                        "Name": "format",
                        "Required": "N",
                        "Default": "xml",
                        "Type": "enumerated",
                        "EnumeratedList": ["csv", "json", "xml"],
			"Description": "Selects the requested response representation format."
                    },
                    {
                        "Name": "client_id",
                        "Required": "N",
                        "Default": "",
                        "Type": "integer",
                        "Description": "Restricts sites to those in client_id to which the user has access."
                    },
                    {
                        "Name": "display_entry_points",
                        "Required": "N",
                        "Default": 0,
                        "Type": "enumerated",
                        "EnumeratedList": [0, 1],
			"Description": "Entry points are starting point URLs for scan crawling. Setting this option will include a list of entry points as a property of the Site resource."
                    },
                    {
                        "Name": "display_assessment_complete",
                        "Required": "N",
                        "Default": 0,
                        "Type": "enumerated",
                        "EnumeratedList": [0, 1],
			"Description":"Expose 'assessment_complete' as a boolean property of the Site resource which indicates whether there are outstanding vulnerabilities under assessment. A false value indicates that either scanning or evaluation is incomplete."
                    },
                    {
                        "Name": "display_vuln_policy",
                        "Required": "N",
                        "Default": 0,
                        "Type": "enumerated",
                        "EnumeratedList": [0, 1],
			"Description":"Expose 'vuln_policy' as an object property of the Site resource which refers to the Vulnerability Policy currently applied to the site."
                    },
                    {
                        "Name": "display_allowed_hosts",
                        "Required": "N",
                        "Default": 0,
                        "Type": "enumerated",
                        "EnumeratedList": [0, 1],
			"Description":"Expose a list of allowed hosts as a property of the Site resource. Allowed hosts are hosts other than the site_url which are allowed be scanned as a part of a Site."
                    },
                    {
                        "Name": "display_scan_status",
                        "Required": "N",
                        "Default": 0,
                        "Type": "enumerated",
                        "EnumeratedList": [0, 1],
			"Description":"Expose a list of scan related indicators as a property on the Site resource. These flags indicate whether scans are running properly and whether user action is required to make scans run."
                    },
                    {
                        "Name": "display_site_credentials",
                        "Required": "N",
                        "Default": 0,
                        "Type": "enumerated",
                        "EnumeratedList": [0, 1],
			"Description":"Expose a list of site credentials which may be used to log into the site under test. These are represented in plain text in order to allow for automated processes. It is recommended that sensitive credentials not be used for this purpose."
                    },
                    {
                        "Name": "display_vuln_stats",
                        "Required": "N",
                        "Default": 0,
                        "Type": "enumerated",
                        "EnumeratedList": [0, 1],
			"Description":"Expose simple statistics about the number of vulns on the Site."
                    },
                    {
                        "Name": "display_scan_schedule",
                        "Required": "N",
                        "Default": 0,
                        "Type": "enumerated",
                        "EnumeratedList": [0, 1],
			"Description":"Expose the scan schedule which indicates when automated scanning will take place."
                    },
                    {
                        "Name": "display_groups",
                        "Required": "N",
                        "Default": 0,
                        "Type": "enumerated",
                        "EnumeratedList": [0, 1],
			"Description":"Expose a list of groups to which the site belongs as a property of the Site resource"
                   },
		   {
                        "Name": "display_all",
                        "Required": "N",
                        "Default": 0,
                        "Type": "enumerated",
                        "EnumeratedList": [0, 1],
			"Description":"A meta-parameter which exposes all of the properties which may be exposed by display parameters."
                   },
		   {
                        "Name": "display_min",
                        "Required": "N",
                        "Default": 0,
                        "Type": "enumerated",
                        "EnumeratedList": [0, 1],
			"Description":"A meta-parameter which exposes only the label and id properties of the Site resource. This parameter is lowest precedence and so other display parameters may be used to expose specific properties."
                   }
		
                ]
            },
            {
                "MethodName": "/site/:site_id",
                "Synopsis": "Returns information on one site",
                "HTTPMethod": "GET",
                "URI": "/site/:site_id",
                "RequiresOAuth": "N",
                "parameters": [
                    {
                        "Name": "site_id",
                        "Required": "Y",
                        "Type": "integer"
                    },
                    {
                        "Name": "format",
                        "Required": "N",
                        "Default": "xml",
                        "Type": "enumerated",
                        "EnumeratedList": ["csv", "json", "xml"],
			"Description": "Selects the requested response representation format."
                    },
                    {
                        "Name": "client_id",
                        "Required": "N",
                        "Default": "",
                        "Type": "integer",
                        "Description": "Restricts sites to those in client_id to which the user has access."
                    },
                    {
                        "Name": "display_entry_points",
                        "Required": "N",
                        "Default": 0,
                        "Type": "enumerated",
                        "EnumeratedList": [0, 1],
			"Description": "Entry points are starting point URLs for scan crawling. Setting this option will include a list of entry points as a property of the Site resource."
                    },
                    {
                        "Name": "display_assessment_complete",
                        "Required": "N",
                        "Default": 0,
                        "Type": "enumerated",
                        "EnumeratedList": [0, 1],
			"Description":"Expose 'assessment_complete' as a boolean property of the Site resource which indicates whether there are outstanding vulnerabilities under assessment. A false value indicates that either scanning or evaluation is incomplete."
                    },
                    {
                        "Name": "display_vuln_policy",
                        "Required": "N",
                        "Default": 0,
                        "Type": "enumerated",
                        "EnumeratedList": [0, 1],
			"Description":"Expose 'vuln_policy' as an object property of the Site resource which refers to the Vulnerability Policy currently applied to the site."
                    },
                    {
                        "Name": "display_allowed_hosts",
                        "Required": "N",
                        "Default": 0,
                        "Type": "enumerated",
                        "EnumeratedList": [0, 1],
			"Description":"Expose a list of allowed hosts as a property of the Site resource. Allowed hosts are hosts other than the site_url which are allowed be scanned as a part of a Site."
                    },
                    {
                        "Name": "display_scan_status",
                        "Required": "N",
                        "Default": 0,
                        "Type": "enumerated",
                        "EnumeratedList": [0, 1],
			"Description":"Expose a list of scan related indicators as a property on the Site resource. These flags indicate whether scans are running properly and whether user action is required to make scans run."
                    },
                    {
                        "Name": "display_site_credentials",
                        "Required": "N",
                        "Default": 0,
                        "Type": "enumerated",
                        "EnumeratedList": [0, 1],
			"Description":"Expose a list of site credentials which may be used to log into the site under test. These are represented in plain text in order to allow for automated processes. It is recommended that sensitive credentials not be used for this purpose."
                    },
                    {
                        "Name": "display_vuln_stats",
                        "Required": "N",
                        "Default": 0,
                        "Type": "enumerated",
                        "EnumeratedList": [0, 1],
			"Description":"Expose simple statistics about the number of vulns on the Site."
                    },
                    {
                        "Name": "display_scan_schedule",
                        "Required": "N",
                        "Default": 0,
                        "Type": "enumerated",
                        "EnumeratedList": [0, 1],
			"Description":"Expose the scan schedule which indicates when automated scanning will take place."
                    },
                    {
                        "Name": "display_groups",
                        "Required": "N",
                        "Default": 0,
                        "Type": "enumerated",
                        "EnumeratedList": [0, 1],
			"Description":"Expose a list of groups to which the site belongs as a property of the Site resource"
                   },
		   {
                        "Name": "display_all",
                        "Required": "N",
                        "Default": 0,
                        "Type": "enumerated",
                        "EnumeratedList": [0, 1],
			"Description":"A meta-parameter which exposes all of the properties which may be exposed by display parameters."
                   },
		   {
                        "Name": "display_min",
                        "Required": "N",
                        "Default": 0,
                        "Type": "enumerated",
                        "EnumeratedList": [0, 1],
			"Description":"A meta-parameter which exposes only the label and id properties of the Site resource. This parameter is lowest precedence and so other display parameters may be used to expose specific properties."
                   }
		
                ]
            },
	                {
                "MethodName": "/site/:site_id",
                "Synopsis": "Update information for one site",
                "HTTPMethod": "PUT",
                "URI": "/site/:site_id",
                "RequiresOAuth": "N",
		"content":{
			"schema":{"type":"string"},
			"contentType":["application/json","application/xml"]
		},
                "parameters": [
                    {
                        "Name": "site_id",
                        "Required": "Y",
                        "Type": "integer"
                    },
                    {
                        "Name": "weight",
                        "Type": "enumerated",
                        "EnumeratedList": [
                            0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10
                         ]
                    },
                    {
                        "Name": "industry",
                        "Type": "enumerated",
                        "EnumeratedList": [
                            "Banking"
                         ]
                    },
                    {
                        "Name": "speed",
                        "Type": "enumerated",
                        "EnumeratedList": [
                            0.0, 0.125, 0.25, 0.5
                         ]
                    },
                    {
                        "Name": "enable_scan_creds",
                        "Type": "enumerated",
                        "EnumeratedList": [0, 1]
                    },
                    {
                        "Name": "vuln_policy_id",
                        "Type": "integer"
                    } 
                ]
            }   
        ]
    },
        {
            "name": "Admin API",
            "methods": [
                {
                    "MethodName": "/:client_id/",
                    "Synopsis": "Manage user access and site groups",
                    "HTTPMethod": "GET",
                    "URI": "/:client_id/",
                    "parameters": [
                        {
                            "Name": "client_id",
                            "Required": "Y"
                        }
                    ]
                }
            ]
        },
        {
            "name": "Job API",
            "methods": [
                {
                    "MethodName": "Fetch a Job",
                    "Synopsis": "GET /api/job/{id} returns a Job resource which describes a runnable configurations such as Scans and Retests",
                    "HTTPMethod": "GET",
                    "URI": "/job/:job_id",
                    "parameters": [
                        {
                            "Name": "job_id",
                            "Required": "N",
                            "Description":"The ID number of the desired Job resource",
                            "Type":"integer"
                        }
                    ]
                },{
                    "MethodName": "Fetch a list of Jobs",
                    "Synopsis": "GET /api/job/ returns a collection of Job resources which describe runnable configurations such as Scans and Retests",
                    "HTTPMethod": "GET",
                    "URI": "/job/",
                    "parameters": [
                    ]
                }
            ]
             
        }
 
    ]
}


